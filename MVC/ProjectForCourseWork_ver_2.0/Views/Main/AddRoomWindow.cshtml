@using Common.DTO
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>AddRentalWindow</title>
</head>
<body>
    <div class="demo-section k-content">
        <ul id="fieldlist">
            <li>
                <label for="buildings">Здание:</label>
                @(Html.Kendo().ComboBox()
                .Name("build")
                .HtmlAttributes(new { style = "width:100%;" })
                .Placeholder("Выберите здание...")
                .DataTextField("Name")
                .DataValueField("Id")
                .Filter(FilterType.Contains)
                .DataSource(source =>
                {
                    source.Read(read =>
                    {
                        read.Action("CascadingGetBuildings", "Rooms");
                    });
                })
                )
            </li>
            <li>
                <label for="buildings">Этаж:</label>
                @(Html.Kendo().ComboBox()
                .Name("floors")
                .HtmlAttributes(new { style = "width:100%;" })
                .Placeholder("Выберите этаж...")
                .DataTextField("Key")
                .DataValueField("Key")
                .Filter(FilterType.Contains)
                .DataSource(source =>
                {
                    source.Read(read =>
                    {
                        read.Action("CascadingGetFloors", "Rooms").Data("filterBuildings");
                    })
                    .ServerFiltering(true);
                })
                //.Enable(false)
                .AutoBind(false)
                .CascadeFrom("build")
                )
            </li>
                <li>
                    <label for="buildings">Тип помещения:</label>
                    @(Html.Kendo().ComboBox()
                    .Name("typeOfRoom")
                    .HtmlAttributes(new { style = "width:100%;" })
                    .Placeholder("Выберите тип помещения...")
                    .DataTextField("Name")
                    .DataValueField("Id")
                    .Filter(FilterType.Contains)
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("CascadingGetTypes", "Rooms");
                        });
                    })
                    )
                </li>
                <li>
                    <label for="rooms">Номер помещения:</label>
                    @(Html.Kendo().TextBox()
                    .Name("number")
                    .HtmlAttributes(new { style = "width:100%;" })
                    .Enable(true)
                    )
                </li>
                <li>
                    <label for="rooms">Площадь помещения:</label>
                    @(Html.Kendo().TextBox()
                    .Name("area")
                    .HtmlAttributes(new { style = "width:100%;" })
                    .Enable(true)
                    )
                </li>
                <li>
                    <button class="k-button k-primary" id="add">Добавить</button>
                </li>
            </ul>
</div>
    <style>
        #fieldlist {
            margin: 0;
            padding: 0;
        }

            #fieldlist li {
                list-style: none;
                padding-bottom: 1.5em;
                text-align: left;
            }

            #fieldlist label {
                display: block;
                padding-bottom: .3em;
                font-weight: bold;
                text-transform: uppercase;
                font-size: 12px;
            }
    </style>
    <script>
     $(document).ready(function () {
        var myWindow = $("#AddRoomWindow");
        var Room = {
            Number: 0,
            Area: 0,
            Floor: 0,
            Type_of_roomId: 0,
            BuildingId: 0
        }//Model
        $("#add").click(function (e) {
            var options = {};
            options.url = 'http://localhost:57109/Rooms/AddRoom';
            options.type = "POST";
            var room = Room;
            room.Number = $("#number").val();
            room.Area = $("#area").val();
            room.Floor = $("#floors").val();
            room.Type_of_roomId = $("#typeOfRoom").val();
            room.BuildingId = $("#build").val();
            console.dir(room);
            options.data = JSON.stringify(room);
            options.contentType = "application/json";
            options.dataType = "html";
            //options.success = function () {
            //    getDetails(planetId);
            //};
            $.ajax(options);
        });
        $("#open").click(function (e) {
            myWindow.data("kendoWindow").open();
            myWindow.data("kendoWindow").center();
        });
    });
    </script>

</body>
</html>
